<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Blog Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background-image: url("images/animals.png");
  background-repeat: repeat;
  background-size: 300px;
  color: white;
}

header {
  background-image: url("images/sakura.jpg");
  background-size: cover;
  background-position: center;
  padding: 40px;
  text-align: center;
  font-size: 28px;
  font-weight: bold;
  text-shadow: 0 3px 8px black;
}

.container {
  max-width: 900px;
  margin: 20px auto;
  background: rgba(0,0,0,0.65);
  padding: 20px;
  border-radius: 20px;
}

input, textarea, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 10px;
  border: none;
}

button {
  background: #ff8ccf;
  font-weight: bold;
  cursor: pointer;
}

.post {
  background: rgba(30,30,45,0.95);
  padding: 15px;
  border-radius: 14px;
  margin-top: 15px;
}

.comment {
  font-size: 14px;
  opacity: 0.9;
  margin-top: 5px;
}

.hidden {
  display: none;
}
</style>
</head>

<body>

<header>üå∏ Blog Platform üå∏</header>

<div class="container" id="auth">
  <h2>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å (6+)">
  <button onclick="register()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  <button onclick="login()">–í–æ–π—Ç–∏</button>
</div>

<div class="container hidden" id="app">
  <p>üë§ <span id="userEmail"></span></p>
  <button onclick="logout()">–í—ã–π—Ç–∏</button>

  <div id="adminPanel" class="hidden">
    <h3>üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h3>
    <input id="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
    <textarea id="content" placeholder="–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏"></textarea>
    <button onclick="addPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
  </div>

  <h2>üìö –°—Ç–∞—Ç—å–∏</h2>
  <div id="posts"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyD26cvWaB4qeX5lAACiIEUMwoIGxSZv4SA",
  authDomain: "artem-c3ba1.firebaseapp.com",
  projectId: "artem-c3ba1",
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const ADMIN_EMAIL = "admin@admin.com";

const authDiv = document.getElementById("auth");
const appDiv = document.getElementById("app");
const adminPanel = document.getElementById("adminPanel");
const userEmail = document.getElementById("userEmail");

auth.onAuthStateChanged(user => {
  if (user) {
    authDiv.classList.add("hidden");
    appDiv.classList.remove("hidden");
    userEmail.textContent = user.email;
    if (user.email === ADMIN_EMAIL) adminPanel.classList.remove("hidden");
    loadPosts();
  } else {
    authDiv.classList.remove("hidden");
    appDiv.classList.add("hidden");
  }
});

function register() {
  auth.createUserWithEmailAndPassword(
    email.value,
    password.value
  ).catch(alert);
}

function login() {
  auth.signInWithEmailAndPassword(
    email.value,
    password.value
  ).catch(alert);
}

function logout() {
  auth.signOut();
}

function addPost() {
  db.collection("posts").add({
    title: title.value,
    content: content.value,
    author: auth.currentUser.email,
    created: Date.now()
  });
}

function loadPosts() {
  db.collection("posts").orderBy("created","desc")
  .onSnapshot(snapshot => {
    posts.innerHTML = "";
    snapshot.forEach(doc => {
      const p = doc.data();
      posts.innerHTML += `
        <div class="post">
          <h3>${p.title}</h3>
          <p>${p.content}</p>
          <small>‚úç ${p.author}</small>
        </div>`;
    });
  });
}
</script>

</body>
</html>
