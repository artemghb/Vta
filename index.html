<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Blog Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f0f14;
  color: white;
  margin: 0;
}
header {
  background: #16161f;
  padding: 15px;
  text-align: center;
  font-size: 22px;
}
.container {
  max-width: 900px;
  margin: auto;
  padding: 15px;
}
input, textarea, button, select {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 8px;
  border: none;
}
input, textarea, select {
  background: #1e1e2e;
  color: white;
}
button {
  background: #5b5bff;
  color: white;
  cursor: pointer;
}
button:hover { background: #7777ff; }
.post {
  background: #1a1a28;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
}
.actions {
  display: flex;
  gap: 10px;
}
.delete { background: #ff4b4b; }
.edit { background: #ffa94b; color: black; }
.hidden { display: none; }
.badge {
  font-size: 12px;
  padding: 3px 6px;
  background: #444;
  border-radius: 5px;
  margin-left: 5px;
}
.admin { background: crimson; }
.public { background: green; }
.private { background: gray; }
</style>
</head>
<body>

<header>üìù –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –±–ª–æ–≥–æ–≤</header>

<div class="container">

<!-- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
<div id="auth">
  <h3>–í—Ö–æ–¥</h3>
  <input id="loginName" placeholder="–ò–º—è">
  <input id="loginPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="login()">–í–æ–π—Ç–∏</button>

  <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
  <input id="regName" placeholder="–ò–º—è">
  <input id="regPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
</div>

<!-- –ü–†–ò–õ–û–ñ–ï–ù–ò–ï -->
<div id="app" class="hidden">

<h3>
üë§ –ê–∫–∫–∞—É–Ω—Ç: <b id="userName"></b>
<span id="roleBadge" class="badge"></span>
</h3>
<button onclick="logout()">–í—ã–π—Ç–∏</button>

<hr>

<h3>–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é</h3>
<input id="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
<textarea id="content" rows="5" placeholder="–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏"></textarea>

<select id="visibility">
  <option value="public">üåç –ü—É–±–ª–∏—á–Ω–∞—è</option>
  <option value="private">üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è</option>
</select>

<button onclick="addPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>

<hr>

<h3>üåç –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏</h3>
<div id="publicPosts"></div>

<hr>

<h3>üìÇ –ú–æ–∏ —Å—Ç–∞—Ç—å–∏</h3>
<div id="myPosts"></div>

</div>
</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || [];
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
let editIndex = null;

function isAdmin() {
  return currentUser === "admin";
}

function save() {
  localStorage.setItem("users", JSON.stringify(users));
  localStorage.setItem("posts", JSON.stringify(posts));
}

function register() {
  const name = regName.value.trim();
  const pass = regPass.value.trim();
  if (!name || !pass) return alert("–ó–∞–ø–æ–ª–Ω–∏ –ø–æ–ª—è");

  if (users.find(u => u.name === name)) return alert("–ò–º—è –∑–∞–Ω—è—Ç–æ");

  users.push({ name, pass });
  save();
  alert("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω");
}

function login() {
  const name = loginName.value.trim();
  const pass = loginPass.value.trim();
  const user = users.find(u => u.name === name && u.pass === pass);
  if (!user) return alert("–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ");

  currentUser = name;
  localStorage.setItem("currentUser", JSON.stringify(name));
  init();
}

function logout() {
  localStorage.removeItem("currentUser");
  location.reload();
}

function init() {
  if (!currentUser) return;
  auth.classList.add("hidden");
  app.classList.remove("hidden");
  userName.textContent = currentUser;
  roleBadge.textContent = isAdmin() ? "ADMIN" : "USER";
  roleBadge.className = "badge " + (isAdmin() ? "admin" : "");
  render();
}

function addPost() {
  const t = title.value.trim();
  const c = content.value.trim();
  const v = visibility.value;
  if (!t || !c) return alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å—ë");

  posts.unshift({
    user: currentUser,
    title: t,
    content: c,
    visibility: v,
    date: new Date().toLocaleString()
  });

  title.value = "";
  content.value = "";
  save();
  render();
}

function deletePost(i) {
  if (!isAdmin() && posts[i].user !== currentUser) return;
  if (confirm("–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é?")) {
    posts.splice(i, 1);
    save();
    render();
  }
}

function render() {
  publicPosts.innerHTML = "";
  myPosts.innerHTML = "";

  posts.forEach((p, i) => {

    // –ü—É–±–ª–∏—á–Ω—ã–µ
    if (p.visibility === "public") {
      publicPosts.innerHTML += `
      <div class="post">
        <h2>${p.title}</h2>
        <small>${p.date} ‚Ä¢ ${p.user}</small>
        <span class="badge public">PUBLIC</span>
        <p>${p.content.replace(/\n/g,"<br>")}</p>
        ${isAdmin() ? `<button class="delete" onclick="deletePost(${i})">üóë</button>` : ""}
      </div>`;
    }

    // –ú–æ–∏
    if (p.user === currentUser) {
      myPosts.innerHTML += `
      <div class="post">
        <h2>${p.title}</h2>
        <small>${p.date}</small>
        <span class="badge ${p.visibility}">${p.visibility.toUpperCase()}</span>
        <p>${p.content.replace(/\n/g,"<br>")}</p>
        <button class="delete" onclick="deletePost(${i})">üóë</button>
      </div>`;
    }

  });
}

init();
</script>

</body>
  </html>
